{% extends "profile_base.html" %} {% block upper %}
<!-- new question -->
<div class="card-nest w-full shadow">
    <!-- prettier-ignore -->
    <div class="card">
        {% if let Some(header) = other.metadata.kv.get("sparkler:motivational_header") %}
            {{ header }}
        {% else %}
            Ask a question
        {% endif %}
    </div>

    <div class="card">
        <!-- prettier-ignore -->
        {% if !lock_profile %}
        {% if (require_account && profile.is_some()) | (disallow_anonymous && profile.is_some()) | (!require_account && !disallow_anonymous) %}
        <form id="question_form" class="flex flex-col gap-2">
            <textarea
                class="w-full"
                placeholder="Type your question!"
                minlength="1"
                maxlength="250"
                required
                name="content"
                id="content"
            ></textarea>

            <!-- prettier-ignore -->
            <div class="flex justify-between w-full gap-1">
                 {% if profile.is_some() && (disallow_anonymous == false) %}
                 <label for="anonymous">
                     <input
                         type="checkbox"
                         name="anonymous"
                         id="anonymous"
                     />

                     Hide your name
                 </label>
                 {% else %}
                 <div></div>
                 {% endif %}

                 <button class="round-lg primary bold">Ask</button>
             </div>
        </form>
        {% else %}
        <b>This profile does not allow anonymous questions.</b>
        {% endif %} {% else %}
        <b>This profile is not currently accepting questions.</b>
        {% endif %}
    </div>
</div>
{% endblock %} {% block pillmenu %}
<a href="/@{{ other.username }}" class="active">
    Answers
    <b class="notification">{{ responses.len() }}</b>
</a>

<a href="/@{{ other.username }}/followers">
    Followers
    <b class="notification">{{ followers_count }}</b>
</a>

<a href="/@{{ other.username }}/following">
    Following
    <b class="notification">{{ following_count }}</b>
</a>
{% endblock %} {% block panel %}
<!-- feed -->
<div id="feed" class="flex flex-col gap-2">
    <!-- pinned -->
    {% if let Some(pinned) = pinned %}
    <div
        class="card-nest w-full shadow"
        id="response:{{ pinned.id }}"
        title="Pinned response"
    >
        <div class="card flex flex-col gap-1">
            <div class="flex justify-between gap-1 question_title">
                <div class="footernav">
                    <b class="flex items-center gap-2 item">
                        <img
                            title="{{ pinned.question.author }}'s avatar"
                            src="/api/v1/profiles/{{ pinned.question.author }}/avatar"
                            alt=""
                            class="avatar round-sm"
                            style="--size: 20px"
                        />

                        {% if pinned.question.author != "anonymous" %}
                        <a
                            href="/@{{ pinned.question.author }}"
                            style="color: inherit"
                        >
                            {{ pinned.question.author }}
                        </a>
                        {% else %} {{ pinned.question.author }} {% endif %}
                    </b>

                    <span class="date item">
                        {{ pinned.question.timestamp }}
                    </span>

                    <span class="item">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 16 16"
                            width="16"
                            height="16"
                            style="color: var(--color-primary)"
                            aria-label="Pin symbol"
                            class="icon"
                        >
                            <path
                                d="M4.456.734a1.75 1.75 0 0 1 2.826.504l.613 1.327a3.08 3.08 0 0 0 2.084 1.707l2.454.584c1.332.317 1.8 1.972.832 2.94L11.06 10l3.72 3.72a.748.748 0 0 1-.332 1.265.75.75 0 0 1-.729-.205L10 11.06l-2.204 2.205c-.968.968-2.623.5-2.94-.832l-.584-2.454a3.08 3.08 0 0 0-1.707-2.084l-1.327-.613a1.75 1.75 0 0 1-.504-2.826ZM5.92 1.866a.253.253 0 0 0-.183-.142.251.251 0 0 0-.221.07L1.794 5.516a.251.251 0 0 0-.07.221c.015.08.068.149.142.183l1.328.613A4.582 4.582 0 0 1 5.73 9.63l.584 2.454a.251.251 0 0 0 .42.12l5.47-5.47a.25.25 0 0 0-.12-.42L9.63 5.73a4.583 4.583 0 0 1-3.098-2.537Z"
                            ></path>
                        </svg>
                    </span>
                </div>
            </div>

            <!-- prettier-ignore -->
            <span class="question_content">
                {{ xsu_util::ui::render_markdown(pinned.question.content)|safe }}
            </span>
        </div>

        <div class="card flex flex-col gap-1">
            <!-- prettier-ignore -->
            <span class="response_content">
                {{ xsu_util::ui::render_markdown(pinned.content)|safe }}
            </span>

            <div class="flex justify-between items-center gap-1 response_title">
                <div class="footernav">
                    <b class="flex items-center gap-2 item">
                        <img
                            title="{{ pinned.author }}'s avatar"
                            src="/api/v1/profiles/{{ pinned.author }}/avatar"
                            alt=""
                            class="avatar round-sm"
                            style="--size: 20px"
                        />

                        <a href="/@{{ pinned.author }}" style="color: inherit">
                            {{ pinned.author }}
                        </a>
                    </b>

                    <span class="date item">{{ pinned.timestamp }}</span>
                </div>

                <div class="dropdown">
                    <button
                        onclick="trigger('app:hook.dropdown', [event])"
                        exclude="dropdown"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 16 16"
                            width="16"
                            height="16"
                            aria-label="Ellipsis symbol"
                            class="icon"
                        >
                            <path
                                d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"
                            ></path>
                        </svg>
                    </button>

                    <div class="inner shadow-md" exclude="dropdown">
                        {% if let Some(profile) = profile %} {% if
                        profile.username == other.username %}
                        <!-- actions for the profile owner only -->
                        <b class="title">Manage</b>
                        <a href="#" onclick="pin_response('')">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 16 16"
                                width="16"
                                height="16"
                                aria-label="Pin symbol"
                                class="icon"
                            >
                                <path
                                    d="M4.456.734a1.75 1.75 0 0 1 2.826.504l.613 1.327a3.08 3.08 0 0 0 2.084 1.707l2.454.584c1.332.317 1.8 1.972.832 2.94L11.06 10l3.72 3.72a.748.748 0 0 1-.332 1.265.75.75 0 0 1-.729-.205L10 11.06l-2.204 2.205c-.968.968-2.623.5-2.94-.832l-.584-2.454a3.08 3.08 0 0 0-1.707-2.084l-1.327-.613a1.75 1.75 0 0 1-.504-2.826ZM5.92 1.866a.253.253 0 0 0-.183-.142.251.251 0 0 0-.221.07L1.794 5.516a.251.251 0 0 0-.07.221c.015.08.068.149.142.183l1.328.613A4.582 4.582 0 0 1 5.73 9.63l.584 2.454a.251.251 0 0 0 .42.12l5.47-5.47a.25.25 0 0 0-.12-.42L9.63 5.73a4.583 4.583 0 0 1-3.098-2.537Z"
                                ></path>
                            </svg>
                            Unpin
                        </a>
                        {% endif %} {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <hr />
    {% endif %}

    <!-- actual feed -->
    {% for response in responses %}
    <div class="card-nest w-full shadow" id="response:{{ response.id }}">
        <div class="card flex flex-col gap-1">
            <div class="flex justify-between gap-1 question_title">
                <div class="footernav">
                    <b class="flex items-center gap-2 item">
                        <img
                            title="{{ response.question.author }}'s avatar"
                            src="/api/v1/profiles/{{ response.question.author }}/avatar"
                            alt=""
                            class="avatar round-sm"
                            style="--size: 20px"
                        />

                        {% if response.question.author != "anonymous" %}
                        <a
                            href="/@{{ response.question.author }}"
                            style="color: inherit"
                        >
                            {{ response.question.author }}
                        </a>
                        {% else %} {{ response.question.author }} {% endif %}
                    </b>

                    <span class="date item">
                        {{ response.question.timestamp }}
                    </span>
                </div>
            </div>

            <!-- prettier-ignore -->
            <span class="question_content">
              {{ xsu_util::ui::render_markdown(response.question.content)|safe }}
          </span>
        </div>

        <div class="card flex flex-col gap-1">
            <!-- prettier-ignore -->
            <span class="response_content">
                 {{ xsu_util::ui::render_markdown(response.content)|safe }}
             </span>

            <div class="flex justify-between items-center gap-1 response_title">
                <div class="footernav">
                    <b class="flex items-center gap-2 item">
                        <img
                            title="{{ response.author }}'s avatar"
                            src="/api/v1/profiles/{{ response.author }}/avatar"
                            alt=""
                            class="avatar round-sm"
                            style="--size: 20px"
                        />

                        <a
                            href="/@{{ response.author }}"
                            style="color: inherit"
                        >
                            {{ response.author }}
                        </a>
                    </b>

                    <span class="date item">{{ response.timestamp }}</span>
                </div>

                <div class="dropdown">
                    <button
                        onclick="trigger('app:hook.dropdown', [event])"
                        exclude="dropdown"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 16 16"
                            width="16"
                            height="16"
                            aria-label="Ellipsis symbol"
                            class="icon"
                        >
                            <path
                                d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"
                            ></path>
                        </svg>
                    </button>

                    <div class="inner shadow-md" exclude="dropdown">
                        {% if let Some(profile) = profile %} {% if
                        profile.username == other.username %}
                        <!-- actions for the profile owner only -->
                        <b class="title">Manage</b>
                        <a href="#" onclick="pin_response('{{ response.id }}')">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 16 16"
                                width="16"
                                height="16"
                                aria-label="Pin symbol"
                                class="icon"
                            >
                                <path
                                    d="M4.456.734a1.75 1.75 0 0 1 2.826.504l.613 1.327a3.08 3.08 0 0 0 2.084 1.707l2.454.584c1.332.317 1.8 1.972.832 2.94L11.06 10l3.72 3.72a.748.748 0 0 1-.332 1.265.75.75 0 0 1-.729-.205L10 11.06l-2.204 2.205c-.968.968-2.623.5-2.94-.832l-.584-2.454a3.08 3.08 0 0 0-1.707-2.084l-1.327-.613a1.75 1.75 0 0 1-.504-2.826ZM5.92 1.866a.253.253 0 0 0-.183-.142.251.251 0 0 0-.221.07L1.794 5.516a.251.251 0 0 0-.07.221c.015.08.068.149.142.183l1.328.613A4.582 4.582 0 0 1 5.73 9.63l.584 2.454a.251.251 0 0 0 .42.12l5.47-5.47a.25.25 0 0 0-.12-.42L9.63 5.73a4.583 4.583 0 0 1-3.098-2.537Z"
                                ></path>
                            </svg>
                            Pin
                        </a>
                        <a
                            href="#"
                            onclick="delete_response('{{ response.id }}')"
                            class="red"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 16 16"
                                width="16"
                                height="16"
                                aria-label="Trash symbol"
                                class="icon"
                            >
                                <path
                                    d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"
                                ></path>
                            </svg>
                            Delete
                        </a>
                        {% endif %} {% endif %}
                        <!-- actions for everybody -->
                        <b class="title">Tools</b>
                        <a
                            href="#"
                            onclick="trigger('app:copy_text', ['{{ response.id }}'])"
                            class="red"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 16 16"
                                width="16"
                                height="16"
                                aria-label="Copy symbol"
                                class="icon"
                            >
                                <path
                                    d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"
                                ></path>
                                <path
                                    d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"
                                ></path>
                            </svg>
                            Copy ID
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% call super() %} {% endblock %}
